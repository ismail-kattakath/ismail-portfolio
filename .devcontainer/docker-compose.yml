version: '3.8'

services:
  app:
    build:
      context: ..
      dockerfile: .devcontainer/Dockerfile
    volumes:
      # Mount the workspace
      - ..:/workspace:cached
      # Persist node_modules as a named volume for better performance
      - node_modules:/workspace/node_modules
      # Mount git config for authentication
      - ~/.gitconfig:/home/node/.gitconfig:ro
    command: sleep infinity
    ports:
      - '3000:3000'
    environment:
      - NODE_ENV=development
    user: node
    working_dir: /workspace

volumes:
  node_modules:
